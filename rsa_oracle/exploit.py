from pwn import *

def encrypt(p, value):
    p.sendline('E')
    p.sendline(value)
    p.recvuntil(') ')
    received = int(p.recvline().strip())
    return received

p = remote('titan.picoctf.net', 62628)

password = 4228273471152570993857755209040611143227336245190875847649142807501848960847851973658239485570030833999780269457000091948785164374915942471027917017922546
two = encrypt(p,b"\x02")

password_mult = password * two

p.sendline('D')
p.sendline(str(password_mult))

p.recvuntil('(c ^ d mod n): ')
password_mult_decrypted = int(p.recvline().strip(),16)
p.close()
password_plain_int = password_mult_decrypted // 2

word_size = (len(hex(password_plain_int))-2)*4

password_plain = pack(password_plain_int, word_size, 'big').decode("utf-8")

print(f"\nplaintext password: {password_plain}")
